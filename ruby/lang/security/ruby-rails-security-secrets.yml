rules:
    - id: ruby-rails-security-secrets
      metadata:
        owasp: 'A3: Sensitive Data Exposure'
        cwe: 'CWE-798: Use of Hard-coded Credentials'
        references: https://github.com/presidentbeef/brakeman/blob/main/lib/brakeman/checks/check_secrets.rb
      message: Detected a potentially hard-coded secret for variable $VAR in source code.
      languages:
      - ruby
      severity: WARNING
      patterns:
      - pattern: |
          $X = "..."
      - pattern-where-python: |
          import re
          re.match(r"password|secret|(rest_auth_site|api)_key$", vars['$X'].lower())

