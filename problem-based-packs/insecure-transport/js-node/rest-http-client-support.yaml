rules:
- id: rest-http-client-support
  patterns:
  - pattern-either:
    - pattern: |
        $CLIENT = require('node-rest-client').Client;
        ...
        $C = new $CLIENT();
        ...
        $C.$REQ("=~/http://.*/", ...);
    - pattern: |
        $AXIOS = require('axios');
        ...
        $AXIOS({url: "=~/http://.*/"});
    - pattern: |
        $AXIOS = require('axios');
        ...
        $AXIOS.$REQ("=~/http://.*/", ...);
    - pattern: |
        $GOT = require('got');
        ...
        $GOT.$REQ("=~/http://.*/", ...);
    - pattern: |
        $GOT = require('got');
        ...
        $GOT("=~/http://.*/", ...);
  message: |
    Checks for requests to http (unencrypted) sites using some of node js's most popular REST/HTTP libraries,
    including node-rest-client, axios, and got. 
  languages:
  - javascript
  severity: WARNING
  metadata:
    cwe: 'CWE-319: Cleartext Transmission of Sensitive Information'
    owasp: 'A3: Sensitive Data Exposure'
    references:
    - https://www.npmjs.com/package/axios
    - https://www.npmjs.com/package/got
    - https://www.npmjs.com/package/node-rest-client
    vulnerability: Insecure Transport
