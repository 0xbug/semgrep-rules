rules:
- id: using-http-server
  patterns:
  - pattern-either:
    - pattern: |
        http.$FUNC(...);
    - pattern: |
        new http.$FUNC2(...);
  message: |
    Checks for any usage of http servers instead of https servers. Encourages the usage of https protocol instead of 
    http, which does not have TLS and is therefore unencrypted. Using http can lead to man-in-the-middle attacks 
    in which the attacker is able to read sensitive information.
  languages:
  - javascript
  severity: WARNING
  metadata:
    cwe: 'CWE=319: Cleartext Transmission of Sensitive Information'
    owasp: 'A3: Sensitive Data Exposure'
    references:
    - https://nodejs.org/api/http.html#http_class_http_agent
    - https://groups.google.com/g/rubyonrails-security/c/NCCsca7TEtY
    vulnerability: Insecure Transport
