rules:
- id: telnet-request
  patterns:
  - pattern-either:
    - pattern: |
        $TEL = require('telnet-client');
        ...
        $SERVER = new $TEL();
        ...
        $SERVER.on(...);
    - pattern: |
        $TEL = require('telnet-client');
        ...
        $SERVER = new $TEL();
        ...
        $SERVER.connect(...);
    - pattern: |
        $TEL = require('telnet');
        ...
        $TEL.createServer(...);
  message: >
    Checks for creation of telnet servers or attempts to connect through telnet. This is insecure as the telnet
    protocol supports

    no encryption, and data passes through unencrypted. 
  languages:
  - javascript
  severity: WARNING
  metadata:
    cwe: 'CWE-319: Cleartext Transmission of Sensitive Information'
    owasp: 'A3: Sensitive Data Exposure'
    references:
    - https://www.npmjs.com/package/telnet
    - https://www.npmjs.com/package/telnet-client
    vulnerability: Insecure Transport
