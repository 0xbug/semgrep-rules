rules:
- id: ftp-request
  patterns:
  - pattern-either:
    - pattern: |
        FTPClient $FTPCLIENT = new FTPClient();
        ...
        $FTPCLIENT.connect(...);
    - pattern: |
        URL $URL = new URL("=~/^[fF][tT][pP]://.*/");
        ...
        URLConnection $CONN = $URL.openConnection(...);
  message: |
    Checks for outgoing connections to ftp servers. FTP does not encrypt traffic, possibly
    leading to PII being sent plaintext over the network.
  languages:
  - java
  severity: WARNING
  metadata:
    cwe: 'CWE-319: Cleartext Transmission of Sensitive Information'
    owasp: 'A3: Sensitive Data Exposure'
    references:
    - https://www.codejava.net/java-se/ftp/connect-and-login-to-a-ftp-server
    - https://commons.apache.org/proper/commons-net/apidocs/org/apache/commons/net/ftp/FTPClient.html
    vulnerability: Insecure Transport
  fix-regex:
    count: 1
    regex: '[fF][tT][pP]://'
    replacement: sftp://
