rules:
- id: bypass-tls-verification
  patterns:
  - pattern-either:
    - pattern: |
        tls.Config{..., InsecureSkipVerify: true, ...}
    - pattern: |
        $CONFIG = &tls.Config{...}
        ...
        $CONFIG.InsecureSkipVerify = true
  message: |
    Checks for disabling of TLS/SSL certificate verification.
     This should only be used for debugging purposes because it leads to vulnerability to MTM attacks.
  languages:
  - go
  severity: WARNING
  metadata:
    cwe: 'CWE-319: Cleartext Transmission of Sensitive Information'
    owasp: 'A3: Sensitive Data Exposure'
    references:
    - https://stackoverflow.com/questions/12122159/how-to-do-a-https-request-with-bad-certificate
    vulnerability: Insecure Transport
